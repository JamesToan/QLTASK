@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using Microsoft.AspNetCore.Http;
@using coreWeb.Controllers;
@{
    Layout = "~/Views/Shared/_Layoutprofile.cshtml";
    ViewData["Title"] = "UserInfo";

    
    var timviec = ViewBag.TimViec;
    var ngld = ViewBag.NguoiLaoDong;
    
   
    var tinhoc = ViewBag.TinHoc;
    var ngoaingu = ViewBag.NgoaiNgu;
    var name = Context.Session.GetString("UserName");
    int? roleid = Context.Session.GetInt32("RoleId");
    int? userid = Context.Session.GetInt32("UserId");
    int? ngldid = Context.Session.GetInt32("NLDID");

}
<link href="~/Content/Assets/vendor/styles/bundle.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="~/Content/Assets/ungvien/css/capnhathoso.css">
<link rel="stylesheet" type="text/css" href="~/Content/Assets/vendor/dropzone/dropzone.css">
<script src="~/Content/Assets/vendor/lib/Sortable.js"></script>
<script src="~/Content/Assets/vendor/dropzone/dropzone.js"></script>


<body class="themeCustom">
    <script src="~/Content/Assets/vendor/jquery/dist/jquery.js"></script>
    <script src="~/Content/Assets/vendor/sweetalert/lib/sweet-alert.min.js"></script>


    <style>
        .grecaptcha-badge {
            display: none !important;
        }
    </style>
    <div class="app layout-fixed-header">
        <!-- sidebar panel -->
        <div class="sidebar-panel offscreen-left">
            <div class="brand">
                <!-- logo -->
                <div class="brand-logo">
                    <div class="imgLogoNtd" id="imgLogoNtd">
                        <img src="~/Content/Assets/images/noimage.jpg">
                        @*<div>
                                <i class="fas fa-camera"></i>
                            </div>*@
                        @*<input class="fileAvatar" type="file" id="fileAvatar" accept="image/x-png,image/gif,image/jpeg">*@
                    </div>
                    <div class="brand-name">
                        @ngld.HoTen
                    </div>
                    @{
                        @using (Html.BeginForm("Logout", "Home", FormMethod.Post))
                        {

                            <button class="" type="submit">
                                <i class="fas fa-sign-out"></i>
                                <span>Đăng xuất</span>
                            </button>
                        }
                    }
                </div>

                <!-- /logo -->
                <!-- toggle small sidebar menu -->
                <a href="javascript:;" class="hidden-lg hidden-md hidden-sm toggle-sidebar hidden-xs hamburger-icon v3" data-toggle="layout-small-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </a>
                <!-- /toggle small sidebar menu -->
            </div>
            <!-- main navigation -->
            <nav role="navigation" style="top: 265px" class="ps-container active open" data-ps-id="5df482b8-8b4a-5bbd-6466-4939bc5152c2">
                <ul class="nav">
                    <li class="">
                        <a href="/UserProfile/Employees">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Quản lý chung</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Đổi mật khẩu</span>
                        </a>
                    </li>
                </ul>
                <div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;"><div class="ps-scrollbar-x" style="left: 0px; width: 0px;"></div></div><div class="ps-scrollbar-y-rail" style="top: 0px; right: 0px;"><div class="ps-scrollbar-y" style="top: 0px; height: 0px;"></div></div>
            </nav>
            <!-- /main navigation -->
        </div>
        <!-- /sidebar panel -->
        <!-- content panel -->
        <div class="main-panel">
            <!-- top header -->
            <header class="header navbar">
                <div class="brand visible-xs">
                    <!-- toggle offscreen menu -->
                    <div class="toggle-offscreen">
                        <a href="#" class="hamburger-icon visible-xs" data-toggle="offscreen" data-move="ltr">
                            <span></span>
                            <span></span>
                            <span></span>
                        </a>
                    </div>
                    <!-- /toggle offscreen menu -->
                    <!-- logo -->
                    <!--                <div class="brand-logo">-->
                    <!--                    <img src="images/logo-dark.png" height="15" alt="">-->
                    <!--                </div>-->
                    <!-- /logo -->
                    <!-- /toggle chat sidebar small screen-->
                </div>
                <ul class="nav navbar-nav">
                    <li class="menu-support">
                        <img class="hidden-xs" src="">
                        <div>
                            Hỗ trợ, tư vấn dành cho ứng viên.
                            <br>
                            <i class="fal fa-phone-alt"></i> <a href="tel: ">(0272) 3871 711 - 3635 223</a>
                            <i class="fal fa-envelope" style="margin-left: 10px"></i> <a href="mailto:vieclam@vieclamlongan.vn">vieclam@vieclamlongan.vn</a>
                        </div>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="menu-ntd">
                        <a href="/">
                            <i class="fal fa-home-alt"></i>
                            <br>
                            Trang chủ
                        </a>
                    </li>
                    @{
                        if (timviec == null)
                        {
                            <li class="menu-ntd">
                                <a href="/UserProfile/EmployeesCV">
                                    <i class="fal fa-id-card"></i>
                                    <br>
                                    Tạo CV
                                </a>
                            </li>
                        }
                        else
                        {
                            <li class="menu-ntd">
                                <a href="/UserProfile/EmployeesCVEdit">
                                    <i class="fal fa-id-card"></i>
                                    <br>
                                    Cập nhật CV
                                </a>
                            </li>
                        }

                    }

                    <li class="menu-ntd">
                        <a href="/TuyenDung">
                            <i class="fal fa-briefcase"></i>
                            <br>
                            Việc làm mới
                        </a>
                    </li>
                    <li class="menu-ntd">
                        <a href="/UserProfile/EditProfileEmployees">
                            <i class="fal fa-clipboard-user"></i>
                            <br>
                            Cập nhật hồ sơ
                        </a>
                    </li>


                </ul>
            </header>
            <!-- /top header -->
            <style>
                .alert {
                    margin-bottom: 10px;
                }
            </style>
            <!-- main area -->
            <div class="main-content">

                <div class="wrapAvatar">
                    <div class="wrapAvatar-image imgLogoNtd">
                        <img src="~/Content/Assets/images/noimage.jpg">
                        @*<span>
                                <i class="fas fa-camera"></i>
                            </span>
                            <input type="file" class="fileAvatar" accept="image/x-png,image/gif,image/jpeg">*@
                    </div>
                    <div class="wrapAvatar-content">
                        <div class="wrapAvatar-content_name">
                            @ngld.HoTen
                        </div>
                        <div class="wrapAvatar-content_text">

                            @{
                                if (timviec != null)
                                {
                                    @timviec.TenCongViec
                                }

                            }
                        </div>

                    </div>
                </div>
                <div class="panel info" id="info-canhan">
                    <div class="panel-heading" data-toggle="panel-collapse">
                        <i class="fas fa-check-circle" style="color: #0099cc; margin-right:5px;"></i>Đổi mật khẩu
                        <i class="fas fa-caret-down pull-right"></i>
                    </div>
                    <div class="panel-body collapse" style="display: block;">
                        <div id="divInfo">
                            <form action="/UserProfile/ChangePass">
                                <div class="col-md-6 col-sm-6 col-xs-12 mb20">
                                    <label class="control-label">Mật khẩu cũ: <span class="required">(*)</span> </label>
                                    <div class="">
                                        <input type="password" name="passold" id="passold" class="form-control" required placeholder="Mật khẩu hiện tại" onChange="checkoldpass();">
                                        <span toggle="#passold" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                    </div>
                                    <div id="checkpass"></div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 mb20">
                                    <label class="control-label">Mật khẩu mới: <span class="required">(*)</span> </label>
                                    <div class="">
                                        <input type="password" name="passnew" id="passnew" class="form-control" placeholder="Mật khẩu mới" required>
                                        <span toggle="#passnew" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 mb20">
                                    <label class="control-label">Xác nhận mật khẩu mới: <span class="required">(*)</span> </label>
                                    <div class="">
                                        <input type="password" id="passnewconform" class="form-control" placeholder="Xác nhận mật khẩu mới" required onChange="checkPasswordMatch();">
                                        <span toggle="#passnewconform" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                    </div>
                                    <div class="">
                                        <div id='CheckPasswordMatch'></div>
                                    </div>
                                </div>
                                <div class="clear-both">

                                </div>
                                <div class="text-center">
                                    <button class="btn btn-primary" id="btnSub" disabled>
                                        <i class="fad fa-check-circle d"></i> Đổi mật khẩu
                                    </button>
                                </div>

                            </form>

                        </div>

                    </div>


                </div>
               

            </div>
            <!-- /main area -->
        </div>
        <!-- /content panel -->
        <script src="https://vieclamcantho.com.vn/view/ungvien/index/js/index.js" type="text/javascript"></script><!-- bottom footer -->
        <footer class="content-footer hidden-xs">
            <nav class="footer-left">
                <ul class="nav">
                    <li>
                        <a href="javascript:;">
                            Copyright <i class="fa fa-copyright"></i> <span>VNPT Long An | https://shop.vnptlongan.vn/ </span>
                            2021
                        </a>
                    </li>
                </ul>
            </nav>
        </footer>
        <!-- /bottom footer -->
    </div>

    <script type="text/javascript" src="~/Content/Assets/ungvien/js/bundle.js"></script>
    <script type="text/javascript" src="~/Content/Assets/ungvien/js/capnhathoso.js"></script>
    <div id="rememberry__extension__root" style="all: unset;"></div>
</body>
<script>
    function checkPasswordMatch() {
        var password = $("#passnew").val();
        var confirmPassword = $("#passnewconform").val();

        if (password != confirmPassword)
            $("#CheckPasswordMatch").html("Mật khẩu xác nhận chưa đúng").css('color', 'red');
        else
            $("#CheckPasswordMatch").html("Mật khẩu xác nhận chính xác.").css('color', 'green');

        if (password == "" && confirmPassword == "") {
            $("#CheckPasswordMatch").html("");
        }
    }

    $(document).ready(function () {
        $("#PasswordConfirm").keyup(checkPasswordMatch);
    });


    var checkpassold = "/UserProfile/checkPassword";

    function checkoldpass() {

        var pass = $("#passold").val();
        _checkPass(pass);
        
    }
        
    
    function _checkPass(id) {
        $.get(checkpassold + "?passnew=" + id, function (data) {
            if (data != null) {
                
                if (data ==true) {
                    $("#checkpass").html("Mật khẩu cũ chính xác.").css('color', 'green');
                    document.getElementById('btnSub').disabled = false;
                }
                else {
                    $("#checkpass").html("Mật khẩu cũ chưa đúng").css('color', 'red');

                }
               
               
            }
        });
    }

    $(".toggle-password").click(function () {

        $(this).toggleClass("fa-eye fa-eye-slash");
        var input = $($(this).attr("toggle"));
        if (input.attr("type") == "password") {
            input.attr("type", "text");
        } else {
            input.attr("type", "password");
        }
    });

</script>
