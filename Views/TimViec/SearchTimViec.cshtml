@{ Layout = "~/Views/Shared/_Frontend.cshtml";
    ViewData["Title"] = "TimViec";

    int skipToPrevious = (int)ViewBag.pPage - 1;
    int PageCount = (int)ViewBag.PageCount;
    int skipToNext = (int)ViewBag.pPage + 1;
    if (skipToNext > PageCount) { skipToNext = 1; };
    if (skipToPrevious < 1) { skipToPrevious = PageCount; };
    int CurrentPage = (int)ViewBag.pageCurrent;
    int pPage = (int)@ViewBag.pPage;

    int skip = ViewBag.Skip;
    var banner = ViewBag.Banner;
    var timviec = ViewBag.TimViec;
    var counTimViec = ViewBag.TimViecSkip;
    var tinh = ViewBag.DMTinh;
    var huyen = ViewBag.DMHuyen;
    var doanhNghiep = ViewBag.DoanhNghiep;
    var vitri = ViewBag.ViTriCongViec;
    var vitricongviec = "";
    var vanbang = ViewBag.VanBang;
    var tglamviec = ViewBag.TGLamViec;
    var nganhnghe = ViewBag.DMNganhNghe;
    var linhvuc = ViewBag.DMLinhVuc;
    var nguoilaodong = ViewBag.NguoiLaoDong;
    var gioitinh = ViewBag.DMGioiTinh;
}
<link href="~/Content/Assets/css/bundle.css" rel="stylesheet" />

<div class="body-view view-news">
    <div class="page_container">
        <div class="view-news-container">
            <div class="main-contentPane left">
                <div class="search-bar position-relative overflow-hidden mb-3">
                   

                    <form action="/TimViec/SearchTimViec">
                        <div class="container">
                            <div class="search-inner">
                                <div class="row row-5 align-items-center">
                                    <div class="col-md-4">
                                        <div class="form-group position-relative mb-0 noidung">
                                            <input type="text" class="form-control rounded-0 transition-03" placeholder="Tiêu đề công việc, tên người lao động..." value="" id="searchStr" name="searchStr">
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="row row-5 align-items-center">
                                            <div class="col-md-5">
                                                <div class="form-group position-relative mb-0 nganhnghe">
                                                    <select class="form-control select2 vieclam-select2 rounded-0 transition-03 select2-hidden-accessible nganhnghes" multiple="" name="searchNN" id="searchNN" data-placeholder="Lọc theo ngành nghề" size="1" tabindex="-1">

                                                        @{
                                                            foreach (var item in nganhnghe)
                                                            {
                                                                <option class="option-items size-085rem" value="@item.Id">
                                                                    @item.TenNganhNghe
                                                                </option>
                                                            }
                                                        }

                                                    </select>

                                                </div>
                                            </div>
                                            <div class="col-md-5">
                                                <div class="form-group position-relative mb-0 diadiem">
                                                    <select class="form-control select2 vieclam-select2 rounded-0 transition-03 select2-hidden-accessible tinhs" name="searchDD" multiple="" id="searchDD" data-placeholder="Lọc theo địa chỉ" size="1" tabindex="-1" aria-hidden="true">

                                                        @{
                                                            foreach (var item in huyen)
                                                            {
                                                                if (item.TinhId == "80")
                                                                {
                                                                    <option class="option-items size-085rem" value="@item.Id">
                                                                        @item.TenHuyen
                                                                    </option>
                                                                }

                                                            }
                                                        }

                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-group position-relative mb-0">
                                                    <button type="submit" class="form-control rounded-0 btn bg-orange transition-03" id="tvsubmit">
                                                        <i class="fal fa-search hidden-small"></i>Tìm
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </form>
                </div>
                <div id="main-content" class="wrapperUngVien ">
                    <div class="">
                        <div class="row row-10">
                            <div class="col-sm-12" id="div-renderUv">
                                <div class="search-results-title">
                                    <p class="fw-500">Tìm kiếm @ViewBag.Searchstring @ViewBag.SNN  @ViewBag.SDD   có @ViewBag.Count kết quả</p>
                                </div>
                                <div class="row row-5" id="listUngVien">
                                    @{

                                        foreach (var item in counTimViec)
                                        {
                                            <div class="col-md-6">
                                                <div class="ungVienItem">
                                                    <div class="ungVienAvatar">
                                                        <div class="ungVienAvatar-inner">
                                                            @{
                                                                @for (int j = 0; j < nguoilaodong.Count; j++)
                                                                {
                                                                    if (item.NguoiLaoDongId == nguoilaodong[j].Id)
                                                                    {
                                                                        <a href="/TimViec/Detail?hsID=@item.Id" title="@nguoilaodong[j].HoTen" class="boxItemBackground lazy tdAjax" data-type="uv" data-id="6043" style="display: flex; background-image: url(/Content/Assets/images/noimage.jpg);"></a>

                                                                    }
                                                                }
                                                            }
                                                        </div>
                                                        
                                                    </div>
                                                    <div class="ungVienContent d-flex flex-column">
                                                        <div class="ungVienJob">

                                                            @{
                                                                for (int j = 0; j < nguoilaodong.Count; j++)
                                                                {
                                                                    if (item.NguoiLaoDongId == nguoilaodong[j].Id)
                                                                    {
                                                                        <a href="/TimViec/Detail?hsID=@item.Id" class="size-095rem  pl-1 text-ellipsis vertical-middle tdAjax" title="" data-toggle="tooltip" data-type="uv" data-id="6043" data-original-title="Tên người lao động: @nguoilaodong[j].HoTen">
                                                                            <i class="fal fa-link w-18"></i>
                                                                            @nguoilaodong[j].HoTen

                                                                        </a>

                                                                        var dateofbirth1 = nguoilaodong[j].NgaySinh.ToString().Split('/', ' ');
                                                                        var dof1 = dateofbirth1[2];
                                                                        <span class="fw-500 size-07rem">
                                                                            @dof1
                                                                        </span>

                                                                        if (nguoilaodong[j].XacThuc == true)
                                                                        {
                                                                            <i class="fas fa-check-circle text-success" title="" data-toggle="tooltip" data-original-title="Đã xác thực số điện thoại"></i>

                                                                        }
                                                                    }
                                                                }
                                                            }


                                                        </div>
                                                        <div class="ungVienName">
                                                            @{
                                                                @for (int j = 0; j < nguoilaodong.Count; j++)
                                                                {
                                                                    if (item.NguoiLaoDongId == nguoilaodong[j].Id)
                                                                    {

                                                                        <a href="/TimViec/Detail?hsID=@item.Id" class="size-09rem pl-1 text-ellipsis vertical-middle tdAjax" title="" data-toggle="tooltip" data-type="uv" data-id="6043" data-original-title="@item.TenCongViec">
                                                                            <i class="fal fa-user-tie"></i>
                                                                            @item.TenCongViec

                                                                        </a>




                                                                    }
                                                                }
                                                            }


                                                        </div>
                                                        <div class="ungVienInfo size-09rem">
                                                            <div class="row row-5">
                                                                <div class="col-md-6">
                                                                    @{
                                                                        if (item.VanBangId != null)
                                                                        {
                                                                            for (int i = 0; i < vanbang.Count; i++)
                                                                            {
                                                                                if (vanbang[i].Id == item.VanBangId)
                                                                                {
                                                                                    <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="@vanbang[i].TenVanBang">
                                                                                        <i class="fal fa-graduation-cap"></i>
                                                                                        @vanbang[i].TenVanBang
                                                                                    </div>
                                                                                }


                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip">
                                                                                <i class="fal fa-graduation-cap"></i>
                                                                                <span>Không xác định</span>

                                                                            </div>
                                                                        }

                                                                    }

                                                                </div>
                                                                <div class="col-md-6">
                                                                    <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="Kinh nghiệm  @item.KinhNghiem">
                                                                        <i class="fal fa-location"></i>
                                                                        @{
                                                                            for (int i = 0; i < huyen.Count; i++)
                                                                            {
                                                                                if (item.NoiLamViecHuyenId == huyen[i].Id)
                                                                                {
                                                                                    @huyen[i].TenHuyen
                                                                                }

                                                                            }
                                                                        }

                                                                        @*@item.KinhNghiem*@
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    @{
                                                                        if (item.MucLuongTu == null && item.MucLuongDen == null)
                                                                        {
                                                                            <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="Mức lương Thỏa thuận">
                                                                                <i class="fal fa-money-bill"></i>
                                                                                Thỏa thuận
                                                                            </div>
                                                                        }
                                                                        else if (item.MucLuongTu != null && item.MucLuongDen == null)
                                                                        {
                                                                            <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="Mức lương trên @item.MucLuongTu triệu">
                                                                                <i class="fal fa-money-bill"></i>
                                                                                Trên @item.MucLuongTu triệu
                                                                            </div>
                                                                        }
                                                                        else if (item.MucLuongTu != null && item.MucLuongDen != null)
                                                                        {

                                                                            <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="Mức lương @item.MucLuongTu - @item.MucLuongDen triệu">
                                                                                <i class="fal fa-money-bill"></i>
                                                                                @item.MucLuongTu - @item.MucLuongDen triệu
                                                                            </div>

                                                                        }
                                                                    }

                                                                </div>
                                                                <div class="col-md-6">
                                                                    @{
                                                                        var date = item.NgayTao.ToString().Split(' ');
                                                                        var time = date[0];
                                                                        <div class="ungVienInfoItem pl-1 text-ellipsis d-inline-block" title="" data-toggle="tooltip" data-original-title="Cập nhât lúc @time">
                                                                            <i class="fal fa-clock"></i>
                                                                            @time
                                                                        </div>
                                                                    }

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }

                                    }


                                </div>
                                <div class="row row-5 justify-content-center" id="phanTrangUngVien">
                                    <nav class="pagination-wrapper d-flex justify-content-center mt-4">
                                        <ul class="pagination">
                                            @{
                                                if (CurrentPage > 1 & PageCount > 1)
                                                {

                                                    <li data-page="1" class="page page-item"> <a class="page-link" href="/TimViec/SearchTimViec??searchStr=@ViewBag.Searchstring&searchNN=@ViewBag.NN&searchDD=@ViewBag.DD&pCount=@skip&pPage=1">&lt;&lt;</a></li>
                                                }

                                                for (int i = 1; i <= PageCount; i++)
                                                {
                                                    if (i == pPage)
                                                    {

                                                        <li data-page="@i" class="page page-item active"><a class="page-link">@i</a></li>

                                                    }
                                                    else
                                                    {

                                                        <li data-page="@i" class="page page-item "><a class="page-link" href="/TimViec/SearchTimViec??searchStr=@ViewBag.Searchstring&searchNN=@ViewBag.NN&searchDD=@ViewBag.DD&pCount=@skip&pPage=@i">@i</a></li>
                                                    }
                                                }
                                                if (PageCount > 1 & CurrentPage < PageCount)
                                                {


                                                    <li data-page="@PageCount" class="page page-item"> <a class="page-link" href="/TimViec/SearchTimViec??searchStr=@ViewBag.Searchstring&searchNN=@ViewBag.NN&searchDD=@ViewBag.DD&pCount=@skip&pPage=@PageCount">&gt;&gt;</a></li>
                                                }

                                            }


                                        </ul>
                                    </nav>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="nav-contentPane right">
                <div class="nav-contentPane-wrapper">
                    <div id="dnn_NewsPage_leftPane">
                        <div class="DnnModule DnnModule-VietNews DnnModule-703">
                            <a name="703"></a>
                            <div id="dnn_ctr703_ContentPane">
                                <!-- Start_Module_703 -->
                                <div id="dnn_ctr703_ModuleContent" class="DNNModuleContent ModVietNewsC">
                                    <input type="hidden" name="dnn$ctr703$ViewVietNews$ctl00$hdfPageCate" id="dnn_ctr703_ViewVietNews_ctl00_hdfPageCate" value="100">
                                    <input type="hidden" name="dnn$ctr703$ViewVietNews$ctl00$hdfCate" id="dnn_ctr703_ViewVietNews_ctl00_hdfCate" value="2">
                                    <div class="banner-qc-all">
                                        @{
                                            foreach (var item in banner)
                                            {
                                                var hinhanh = item.HinhAnh.ToString().Split('[', ']', '"');
                                                var hinh = hinhanh[2];
                                                <div class="banner-qc">
                                                    <a href="@item.Link" target="@item.Target">
                                                        <img class="qc-banner" src="~/images/@hinh" />
                                                    </a>

                                                </div>
                                            }

                                        }

                                    </div>


                                </div><!-- End_Module_703 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clear">
            </div>
        </div>

    </div>

</div>

<script src="~/Content/Assets/js/bundle.js" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $('.nganhnghes').select2({
            maximumSelectionLength: 1
        });
    });
    $(document).ready(function () {
        $('.tinhs').select2({
            maximumSelectionLength: 1
        });
    });
</script>
